(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0eef21de"],{"060a":function(e,t,a){e.exports=a.p+"static/img/alipay.6b1792a3.png"},"3d9f":function(e,t,a){e.exports=a.p+"static/img/alipay-h.ae0e52f3.png"},"6f5b":function(e,t,a){e.exports=a.p+"static/img/wxpay.671037f1.png"},e7e1:function(e,t,a){"use strict";a.r(t);var l=a("7a23"),o=a("6f5b"),n=a.n(o),i=a("060a"),r=a.n(i),c=a("3d9f"),s=a.n(c);const d={style:{color:"white","font-size":"25px","padding-bottom":"30px"}},p={style:{height:"170px"}},b={style:{position:"relative"}},u=["src"],g=["src"],m=Object(l["createElementVNode"])("div",{style:{"margin-bottom":"50px"}},null,-1),y=Object(l["createTextVNode"])("充值"),j=Object(l["createElementVNode"])("div",{style:{"margin-bottom":"50px"}},null,-1),O=Object(l["createTextVNode"])(" 积分"),h=Object(l["createElementVNode"])("br",null,null,-1),w=Object(l["createElementVNode"])("br",null,null,-1),x=Object(l["createTextVNode"])("    "),V={key:1,src:s.a,alt:"alipay",style:{width:"50px",cursor:"not-allowed"}},f=Object(l["createElementVNode"])("br",null,null,-1),N=["src"],I=Object(l["createElementVNode"])("br",null,null,-1),C=Object(l["createTextVNode"])("完成");function E(e,t,a,o,i,c){const s=Object(l["resolveComponent"])("el-col"),E=Object(l["resolveComponent"])("el-row"),_=Object(l["resolveComponent"])("el-button"),k=Object(l["resolveComponent"])("el-table-column"),B=Object(l["resolveComponent"])("el-table"),P=Object(l["resolveComponent"])("el-pagination"),S=Object(l["resolveComponent"])("el-input-number"),A=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",d,[Object(l["createVNode"])(E,{justify:"center",align:"middle"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{lg:{span:3},xs:{span:10},sm:{span:4}},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",p,[Object(l["createElementVNode"])("div",b,[Object(l["createElementVNode"])("img",{src:i.celestialBody.smallBackground,style:{position:"absolute",left:"20px",top:"5px",width:"140px"},alt:""},null,8,u),Object(l["createElementVNode"])("img",{src:i.celestialBody.smallTexture,style:Object(l["normalizeStyle"])("position:absolute;left:20px;top:5px;width: 140px;transform:rotate("+i.celestialBody.angle+"deg);"),alt:""},null,12,g)])])]),_:1}),Object(l["createVNode"])(s,{lg:{span:4},xs:{span:10},sm:{span:4}},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("a",null,Object(l["toDisplayString"])(i.userInfo.nickName),1)]),_:1})]),_:1}),m,Object(l["createVNode"])(E,{justify:"center",align:"middle"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{lg:{span:4},xs:{span:10},sm:{span:5}},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])(" 积分: "+Object(l["toDisplayString"])(i.userInfo.integral),1)]),_:1}),Object(l["createVNode"])(s,{lg:{span:4},xs:{span:5},sm:{span:5}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(_,{type:"primary",onClick:c.payDialog,round:""},{default:Object(l["withCtx"])(()=>[y]),_:1},8,["onClick"])]),_:1})]),_:1}),j,Object(l["createVNode"])(E,{justify:"center"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{lg:{span:6},xs:{span:24},sm:{span:10}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(B,{data:i.orders.content,style:{width:"440px"},border:""},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(k,{prop:"startedAt",label:"创建时间",width:"160px"}),Object(l["createVNode"])(k,{label:"通道",width:"70px"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(i.channel[e.row.channelType]),1)]),_:1}),Object(l["createVNode"])(k,{label:"金额",width:"100px"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.row.amount/100)+" 元 ",1)]),_:1}),Object(l["createVNode"])(k,{label:"状态"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(i.status[e.row.status]),1)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),Object(l["createVNode"])(P,{background:"",layout:"prev, pager, next","current-page":i.query.page,"page-size":i.query.size,total:i.orders.totalElements,onCurrentChange:c.list},null,8,["current-page","page-size","total","onCurrentChange"]),Object(l["createVNode"])(A,{modelValue:i.dialogPayVisible,"onUpdate:modelValue":t[3]||(t[3]=e=>i.dialogPayVisible=e),title:"充值",width:"370px"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(S,{modelValue:i.payIntegral,"onUpdate:modelValue":t[0]||(t[0]=e=>i.payIntegral=e),min:100},null,8,["modelValue"]),O,h,w,Object(l["createElementVNode"])("img",{src:n.a,alt:"wxpay",style:{width:"50px",cursor:"pointer"},onClick:t[1]||(t[1]=e=>c.pay("wx"))}),x,"wx"!==i.browser?(Object(l["openBlock"])(),Object(l["createElementBlock"])("img",{key:0,src:r.a,alt:"alipay",style:{width:"50px",cursor:"pointer"},onClick:t[2]||(t[2]=e=>c.pay("alipay"))})):Object(l["createCommentVNode"])("",!0),"wx"===i.browser?(Object(l["openBlock"])(),Object(l["createElementBlock"])("img",V)):Object(l["createCommentVNode"])("",!0),f]),_:1},8,["modelValue"]),Object(l["createVNode"])(A,{modelValue:i.dialogPay2Visible,"onUpdate:modelValue":t[4]||(t[4]=e=>i.dialogPay2Visible=e),width:"370px"},{default:Object(l["withCtx"])(()=>[i.StringUtils.isNotBlank(i.wxCode)?(Object(l["openBlock"])(),Object(l["createElementBlock"])("img",{key:0,style:{width:"300px"},src:i.wxCode,alt:"wxCode"},null,8,N)):Object(l["createCommentVNode"])("",!0),I,Object(l["createVNode"])(_,{type:"primary",onClick:c.queryCharge,round:""},{default:Object(l["withCtx"])(()=>[C]),_:1},8,["onClick"])]),_:1},8,["modelValue"])])}var _=a("b775"),k=a("4995");const B=a("7c15"),P=a("3fa2");var S={name:"UserCenter",created(){this.getUserInfo();let e=navigator.userAgent.toLowerCase();console.log(e),e.indexOf("micromessenger")>0?this.browser="wx":e.indexOf("mobile")>0?this.browser="wap":this.browser="pc"},data(){return{browser:"",payChannel:"",payIntegral:0,dialogPayVisible:!1,dialogPay2Visible:!1,wxCode:"",userInfo:{id:"",nickName:"",integral:0},celestialBody:{smallBackground:"",smallTexture:"",angle:0},query:{page:1,size:10},orders:{totalElements:0,content:[{}]},channel:{ALIPAY_WAP:"支付宝",ALIPAY_WEB:"支付宝",WEIXIN_H5:"微信",WEIXIN_JSAPI:"微信",WEIXIN_MINI_APP:"微信",WEIXIN_PC:"微信"},status:{SUCCEEDED:"成功",STARTED:"支付中",FAILED:"失败"},StringUtils:P}},methods:{getUserInfo(){const e=localStorage.getItem("userInfo");P.isBlank(e)?this.$emit("login"):(this.userInfo=JSON.parse(e),this.celestialBodyInfo(),this.list(1))},celestialBodyInfo(){_["a"].get(B.celestialBodyInfo+"?type=USER&id="+this.userInfo.id).then(e=>{this.celestialBody=e.data})},login(){this.dialogVisible=!0},payDialog(){this.dialogPayVisible=!0},pay(e){let t={amount:this.payIntegral,state:location.href};if("wx"===e&&"pc"===this.browser)t.type="WEIXIN_PC";else if("wx"===e&&"wx"===this.browser)t.type="WEIXIN_JSAPI";else if("wx"===e&&"wap"===this.browser)t.type="WEIXIN_H5";else if("alipay"===e&&"pc"===this.browser)t.type="ALIPAY_WEB";else{if("alipay"!==e||"wap"!==this.browser)return void Object(k["a"])({message:"不支持的支付方式",type:"error"});t.type="ALIPAY_WAP"}_["a"].post(B.recharge,t).then(e=>{console.log(e),"WEIXIN_PC"===t.type?this.wxCode="https://api.pwmqr.com/qrcode/create/?url="+e.data.qr:"ALIPAY_WEB"===t.type||"ALIPAY_WAP"===t.type?window.open(e.data.html):"WEIXIN_H5"===t.type?window.open(e.data.url):"WEIXIN_JSAPI"===t.type&&this.onBridgeReady(e.data),this.dialogPay2Visible=!0})},list(e){this.query.page=e,e=e>0?e-1:0,_["a"].get(B.orders+"?channelType=ALL&page="+e).then(e=>{this.orders=e.data})},queryCharge(){this.dialogPayVisible=!1,this.dialogPay2Visible=!1,_["a"].get(B.userInfo).then(e=>{this.userInfo=e.data,this.loginBool=!0,localStorage.setItem("userInfo",this.userInfo.toString()),localStorage.setItem("loginBool","true"),this.list(this.query.page)})},onBridgeReady(e){WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e.appId,timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign},(function(e){}))}}},A=a("6b0d"),v=a.n(A);const W=v()(S,[["render",E]]);t["default"]=W}}]);